#
cat > job.f << eof
      PROGRAM FILTER
      open(unit=80,form='formatted')
      tb=2
      ta=7
      dt=1
      delta=0.01
      n=10
      CALL HAMING(tb,ta,dt,delta,n)
      STOP
      END
      SUBROUTINE HAMING(TB,TA,DT,DELTA,N)
C      TB MUST BE LESS THAN TA
      DIMENSION C(51),H(51,1)
      DATA PI/3.141592653/
      FB=DT/TB
      FA=DT/TA
      A=-ALOG10(DELTA)*20.
      DF=(A-7.95)/FLOAT(N)/28.72
      IF (A.LE.21.) ALPHA=0.
      IF (A.GT.21.AND.A.LT.50.) ALPHA=0.5842*(A-21.)**(0.4)+
     1    0.07886*(A-21.)
      IF (A.GE.50.) ALPHA=0.1102*(A-8.7)
      CONST=FUNC(ALPHA,0,N)
      C(1)=2.*(FB-FA)
      DO 10 K=1,N
      ANGLE1=2.*PI*FLOAT(K)*FB
      ANGLE2=2.*PI*FLOAT(K)*FA
      C(K+1)=(SIN(ANGLE1)-SIN(ANGLE2))/FLOAT(K)/PI*FUNC(ALPHA,K,N)/CONST
   10 CONTINUE
      PRINT 1,TB,TA,FB,FA,DELTA,A,DF,ALPHA
      NN=N+1
      DO 20 K=1,NN
      KK=K-1
      PRINT 2,KK,C(K)
   20 CONTINUE
    1 FORMAT(///,1X,'TB=',F10.1,2X,'TA=',F10.1,2X,'FB=',E10.3,2X,
     1    'FA=',E10.3,2X,'DELTA=',F5.3,2X,'A=',F5.1,2X,'DF=',
     1    E10.3,2X,'ALPHA=',E10.3)
    2 FORMAT(10X,'C(',I2,') = ',F20.10)
      print 33,(c(k),k=1,nn)
      write(80,888) c
 888  format(10f7.2)
  33  format(6x,'data c/',(f13.10,','))
      F=-0.01
      DO 30 J=1,51
      F=F+0.01
      H(J,1)=C(1)
      DO 25 I=1,N
      ANGLE=2.*PI*FLOAT(I)*F
      H(J,1)=H(J,1)+2.*C(I+1)*COS(ANGLE)
   25 CONTINUE
   30 CONTINUE
      RETURN
      END
      FUNCTION FUNC(ALPHA,K,N)
      Y=1.-(FLOAT(K)/FLOAT(N))**2
      X=ALPHA*SQRT(Y)/2.
      FUNC=1.
      DO 10 J=1,20
      FAC=1.
      DO 9 I=1,J
      FAC=FAC*FLOAT(I)
    9 CONTINUE
      FUNC=FUNC+(X**J/FAC)**2
   10 CONTINUE
      RETURN
      END
eof
gfortran job.f
a.out
mv fort.80 Lau_filter.data
\rm job.f a.out
