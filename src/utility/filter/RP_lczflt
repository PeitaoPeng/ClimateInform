#
cat > job.f << eof
      PROGRAM FILTER
      parameter(n=30,M=600)
      dimension RP(M),c(n)
      tc=8   !tc=cutoff period
      dt=1
      fc=dt/tc
      CALL LANCZOS(FC,N,C)
      CALL RPLANCZOS(C,N,M,RP)
      STOP
      END
      SUBROUTINE LANCZOS(FC,N,C)
      DIMENSION C(N)
      DATA PI/3.141592653/
      C(1)=2*FC
      DO k=1,N-1
        XNO=sin(2*pi*fc*k)*sin(pi*k/n)
        DNM=(pi*k)*(pi*k)/n
        C(k+1)=XNO/DNM
      ENDDO
      print 33,(c(k),k=1,n)
  33  format(6x,'data c/',(f13.10,','))
      RETURN
      END
      SUBROUTINE RPLANCZOS(C,N,M,RP)
      DIMENSION C(N),RP(M)
      DATA PI/3.141592653/
      df=1/(2*float(M))
      DO mf=1,M
      RP(mf)=C(1)
        f=mf*df
      DO k=1,N-1
        RP(mf)=RP(mf)+2*C(k+1)*cos(2*pi*k*f)
      ENDDO
      ENDDO
      write(80) RP
      RETURN
      END
eof
f77 job.f
a.out
mv fort.80 RP_Lczflt.data
\rm job.f a.out
