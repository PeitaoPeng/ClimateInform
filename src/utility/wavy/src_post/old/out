52,53c52,53
<       IMPLICIT REAL (A-H,O-Z)
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>        IMPLICIT REAL(A-H,O-Z)
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
55c55
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
259c259
<       CALL SETDA
---
>       IF(SEQDA.EQ.'DIRA')CALL SETDA
351a352,356
> C     IF(SEQDA.EQ.'SEQU')WRITE(NPFILE)IYR,MONTH,IDAY,HR
> C     IF(SEQDA.EQ.'DIRA')THEN
> C     WRITE(UNIT=NPFILE,REC=IREC,IOSTAT=IER)IYR,MONTH,IDAY,HR
> C     IREC=IREC+1
> C     END IF
433d437
< 
483c487
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
485c489
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
548c552
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
550c554
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
657c661
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
659c663
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
684c688
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
686c690
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
709c713
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
711c715
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
746c750
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
748c752
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
784c788
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
786c790
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
829c833
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
831c835
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
900c904
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
902c906
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
962c966
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
964c968
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
1216c1220
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
1218c1222
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
1242c1246
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
1244c1248
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
1291,1292c1295
< C     SUBROUTINE PLN2(SLN,COLRAD,LAT,XXX)
<       SUBROUTINE PLN2(SLN,COLRAD,LAT)
---
>       SUBROUTINE PLN2(SLN,COLRAD,LAT,XXX)
1294c1297
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
1296c1299
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
1432c1435
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
1434c1437
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
1592,1593c1595
< C     CALL PLN2(PLN(1,LAT),COLRAD,LAT,EPS)
<       CALL PLN2(PLN(1,LAT),COLRAD,LAT)
---
>       CALL PLN2(PLN(1,LAT),COLRAD,LAT,EPS)
1705c1707
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
1707c1709
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
1964c1966
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
1966c1968
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
2223c2225
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
2225c2227
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
2446c2448
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
2448c2450
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
2656c2658
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
2658c2660
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
2880c2882
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
2882c2884
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
2904c2906
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
2906c2908
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
2939c2941
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
2941c2943
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
3199c3201
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
3201c3203
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
3222,3223c3224
< C     DATA PAD/X'5555555555555555'/      !it is for cray
<       DATA PAD/X'55555555'/
---
>       DATA PAD/X'5555555555555555'/
3241a3243,3271
>       IF(SEQDA.EQ.'DIRA')THEN
> C    DIRECT ACCESS RECORDS ARE LRCLW WORDS LONG.  NBF RECORDS ARE
> C    NEEDED TO SPAN BFR WHICH IS LTLO LONG.  EXTRA SPACE IS PADDED
>       I=1
>       J=1
>       DO 20 KK=1,NBF-1
>       DO 15 JJ=1,LRCLW
>       DABFR(JJ)=BBFR(I,J)
>       I=I+1
>       IF(I.GT.LONR)THEN
>       I=1
>       J=J+1
>       END IF
>    15 CONTINUE
>       CALL WRO(DABFR,LRCLW)
>    20 CONTINUE
>       DO 30 JJ=1,IPS-1
>       DABFR(JJ)=BBFR(I,J)
>       I=I+1
>       IF(I.GT.LONR)THEN
>       I=1
>       J=J+1
>       END IF
>    30 CONTINUE
>       DO 40 JJ=IPS,LRCLW
>       DABFR(JJ)=PAD
>    40 CONTINUE
>       CALL WRO(DABFR,LRCLW)
>       END IF
3245d3274
< 
3247c3276
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
3249c3278
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
3268c3297
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
3270c3299
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
3284c3313,3327
<      * RECL=4*LRCLW)
---
>      * IOSTAT=IER,RECL=LRCLB,STATUS='NEW')
>       IF(IER.NE.0)GO TO 25
> C***** LINES BETWEEN STARRED COMMENT CARDS ADDED TO CORRECT SYSTEM BUG
> C     CALL GETFID(NPFILE,1,FID,IER1)
> C     IF(IER1.NE.0)GO TO 50
> C     ERS(1:6)='ERASE '
> C     ERS(7:14)=FID(1:8)
> C     ERS(15:15)=' '
> C     ERS(16:23)=FID(9:16)
> C     ERS(24:24)=' '
> C     ERS(25:26)=FID(17:18)
> C     ERS(27:27)='$'
> C     CALL OPSYS('$',ERS,IER2)
> C     IF(IER2.NE.0)GO TO 100
> C***** END OF SYSTEM BUG CORRECTION
3285a3329,3330
>       NBF=LTLO/LRCLW+1
>       IPS=LTLO-(NBF-1)*LRCLW+1
3286a3332,3341
>    25 LRECL=LRCLB
>       WRITE(3,33)NPFILE,LRECL,IER
>    33 FORMAT(' ERROR OPENING ON UNIT',I3,' LRECL=',I5,' ERROR=',I5)
>       STOP 33
>    50 WRITE(3,63)NPFILE,IER1
>    63 FORMAT(' ERROR OBTAINING FILE ID FROM UNIT',I3,' ERROR=',I5)
>       STOP 63
>   100 WRITE(3,103)FID,IER2
>   103 FORMAT(' ERROR ERASING FILE ID ',A18,' ERROR=',I5)
>       STOP 103
3288d3342
< 
3316c3370
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
3318c3372
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
3472c3526
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
3474c3528
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
3673c3727
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
3675c3729
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
3850c3904
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
3852c3906
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
4030c4084
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
4032c4086
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
4263c4317
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
4265c4319
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
4314c4368
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
4316c4370
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
4365c4419
<       PARAMETER (LONR=64,LATR=40,LONG=64,LATG=40,JWAVE=16,KWAVE=16,
---
>       PARAMETER (LONR=48,LATR=40,LONG=48,LATG=40,JWAVE=16,KWAVE=16,
4367c4421
<      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4*LONG*LATG)
---
>      *FIRSTX=0.0,FIRSTY=90.0,LRCLB=4096)
4393d4446
< 
4399a4453
>       IF(SEQDA.EQ.'SEQU')THEN
4401c4455
<       IF (ABS(BFR(I)).LT.1.E-30) BFR(I)=0.
---
>         IF (ABS(BFR(I)).LT.1.E-30) BFR(I)=0.
4403c4457,4461
<       WRITE(NPFILE,rec=IREC)BFR
---
>       WRITE(NPFILE)BFR
>       END IF
>       IF(SEQDA.EQ.'DIRA')THEN
>       WRITE(UNIT=NPFILE,REC=IREC,IOSTAT=IER)BFR
>       IF(IER.NE.0)GO TO 100
4404a4463
>       END IF
4405a4465,4467
>   100 WRITE(3,113)NPFILE,IREC,IER
>   113 FORMAT(' ERROR WITING TO UNIT',I3,' IREC=',I5,' IER=',I5)
>       STOP 113
