      program T62toR15
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C  from gausian grid to regular grid or vice versa
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
      include "parm.h"
      PARAMETER (imx=384,jmx=190,imx2=64,jmx2=40)
      real ygr15(jmx2),ygt126(jmx),xx(imx),xx2(imx2)
      real yy(jmx),yy2(jmx2),
     %     grd1(imx,jmx),grd2(imx2,jmx2),
     %     fout(imx2,jmx2)

      data ygt126/
     &-89.277,-88.340,-87.397,-86.454,-85.509,-84.565,-83.620,-82.676,
     &-81.731,-80.786,-79.841,-78.897,-77.952,-77.007,
     &-76.062,-75.117,-74.173,-73.228,-72.283,-71.338,-70.393,-69.448,
     &-68.503,-67.559,-66.614,-65.669,-64.724,-63.779,
     &-62.834,-61.889,-60.945,-60.000,-59.055,-58.110,-57.165,-56.220,
     &-55.275,-54.330,-53.386,-52.441,-51.496,-50.551,
     &-49.606,-48.661,-47.716,-46.771,-45.827,-44.882,-43.937,-42.992,
     &-42.047,-41.102,-40.157,-39.212,-38.268,-37.323,
     &-36.378,-35.433,-34.488,-33.543,-32.598,-31.653,-30.709,-29.764,
     &-28.819,-27.874,-26.929,-25.984,-25.039,-24.094,
     &-23.150,-22.205,-21.260,-20.315,-19.370,-18.425,-17.480,-16.535,
     &-15.590,-14.646,-13.701,-12.756,-11.811,-10.866,
     & -9.921, -8.976, -8.031, -7.087, -6.142, -5.197, -4.252, -3.307,
     & -2.362, -1.417, -0.472,  0.472,  1.417,  2.362,
     &  3.307,  4.252,  5.197,  6.142,  7.087,  8.031,  8.976,  9.921, 
     & 10.866, 11.811, 12.756, 13.701, 14.646, 15.590,
     & 16.535, 17.480, 18.425, 19.370, 20.315, 21.260, 22.205, 23.150,
     & 24.094, 25.039, 25.984, 26.929, 27.874, 28.819,
     & 29.764, 30.709, 31.653, 32.598, 33.543, 34.488, 35.433, 36.378,
     & 37.323, 38.268, 39.212, 40.157, 41.102, 42.047,
     & 42.992, 43.937, 44.882, 45.827, 46.771, 47.716, 48.661, 49.606,
     & 50.551, 51.496, 52.441, 53.386, 54.330, 55.275,
     & 56.220, 57.165, 58.110, 59.055, 60.000, 60.945, 61.889, 62.834,
     & 63.779, 64.724, 65.669, 66.614, 67.559, 68.503,
     & 69.448, 70.393, 71.338, 72.283, 73.228, 74.173, 75.117, 76.062,
     & 77.007, 77.952, 78.897, 79.841, 80.786, 81.731,
     & 82.676, 83.620, 84.565, 85.509, 86.454, 87.397, 88.340, 89.277/
C
      data ygr15/     -86.598,-82.191,-77.758,-73.319,-68.878,-64.435,
     &-59.992,-55.549,-51.106,-46.662,-42.218,-37.774,-33.330,-28.886,
     &-24.442,-19.998,-15.554,-11.110, -6.666,-2.222,
     & 2.222,6.666,11.110,15.554,19.998,24.442,28.886,33.330,37.774,
     & 42.218,46.662,51.106,55.549,59.992,64.435,68.878,73.319,
     & 77.758,82.191,86.598/
C
      open(unit=11,form='unformatted',access='direct',recl=imx*jmx*4)
      open(unit=61,form='unformatted',access='direct',recl=imx2*jmx2*4)
C
      DXX =360.0/float(imx)
      DXX2=360.0/float(imx2)
      CALL SETXY(XX, imx, yy ,jmx, 0.0,DXX, 0.0,0.0)
      CALL SETXY(XX2,imx2,yy2,jmx2,0.0,DXX2,0.0,0.0)
C
      iu=11
      iuo=61
C
      IF(iskip.lt.1) go to 666
      do is=1,iskip
        read(iu) grd1
      end do
  666 continue

      do 1000 kk=1,ltime
      read(iu,rec=kk)  grd1
      write(6,*)'grd1(20,20)=',grd1(20,20)
      call intp2d(grd1,imx,jmx,xx,ygt126,grd2,imx2,jmx2,xx2,ygr15,0)
      call norsou(grd2,fout,imx2,jmx2)
c     write(iuo) fout
      write(iuo,rec=kk) grd2
      write(6,*)'it=',kk,'grd2(20,20)=',grd2(20,20)
 1000 continue
      write(6,*)'ygr15=',ygr15
      write(6,*)'xx=',xx    
      write(6,*)'xx2=',xx2   

      stop
      END

      SUBROUTINE norsou(fldin,fldot,lon,lat)
      dimension fldin(lon,lat),fldot(lon,lat)
      do 100 j=1,lat
      do 100 i=1,lon
      fldot(i,j)=fldin(i,lat+1-j)
  100 continue
      return
      end

