** Create standardized 3-month running mean NAO index plot
pen 
'reinit'
*'open /cpc/consistency/telecon/gb/monthly_nao_indices.gb2000.ctl'
*'open /cpc/consistency/telecon/gb/monthly_raw_tele_indices.gb2000.ctl'
'open /cpc/consistency/telecon/gb/monthly_raw_tele_indices.2000.no_cos.proj.ctl'
'open /cpc/consistency/telecon/gb/monthly_raw_tele_indices.2000.proj.ctl'
'open /cpc/consistency/telecon/gb/monthly_raw_tele_indices.2000.proj.ctl'
*'open /cpc/consistency/telecon/gb/monthly_tele_indices.2000.ctl'
*'open /cpc/consistency/telecon/gb/monthly_tele_indices.2000.no_cos.ctl'
*
'enable print mon.nao.gx' 
*
*pull month
*pull year
month=June
year=2022
say month year
if(month = "December");imoend=12;cmon=dec;endif
if(month = "January");imoend=1;cmon=jan;endif
if(month = "February");imoend=2;cmon=feb;endif
if(month = "March");imoend=3;cmon=mar;endif
if(month = "April");imoend=4;cmon=apr;endif
if(month = "May");imoend=5;cmon=may;endif
if(month = "June");imoend=6;cmon=jun;endif
if(month = "July");imoend=7;cmon=jul;endif
if(month = "August");imoend=8;cmon=aug;endif
if(month = "September");imoend=9;cmon=sep;endif
if(month = "October");imoend=10;cmon=oct;endif
if(month = "November");imoend=11;cmon=nov;endif
*
'set t 1 12'
'define clm1=ave('nao',t+0,t=852,12)'
'define clm2=ave('nao.2',t+0,t=852,12)'
'define clm3=ave('nao.3',t+0,t=852,12)'
'modify clm1 seasonal'
'modify clm2 seasonal'
'modify clm3 seasonal'
*'define var = ave(pow('nao'-clim,2),t+372,t=732,12)'
'define var1 = ave(pow('nao'-clm1,2),t+0,t=852,12)'
'define var2 = ave(pow('nao.2'-clm2,2),t+0,t=852,12)'
'define var3 = ave(pow('nao.3'-clm3,2),t+0,t=852,12)'
'modify var1 seasonal'
'modify var2 seasonal'
'modify var3 seasonal'
'set time jan1950 'cmon''year
'define nidx1=('nao'-clm1)/sqrt(var1)'
'define nidx2=('nao.2'-clm2)/sqrt(var2)'
'define nidx3=('nao.3'-clm3)/sqrt(var3)'
*
*calculate standarized 3-month running mean index values
*
'set time jan1950 'cmon''year
'define runm1=ave(nidx1,t-2,t+0)'
'define runm2=ave(nidx2,t-2,t+0)'
'define runm3=ave(nidx3,t-2,t+0)'
'set t 1 12'
*'define clim2=ave(runmean,t+372,t=732,12)'
'define clm21=ave(runm1,t+0,t=852,12)'
'define clm22=ave(runm2,t+0,t=852,12)'
'define clm23=ave(runm3,t+0,t=852,12)'
'modify clm21 seasonal'
'modify clm22 seasonal'
'modify clm23 seasonal'
*'define var2 = ave(pow(runmean-clim2,2),t+372,t=732,12)'
'define var21 = ave(pow(runm1-clm21,2),t+0,t=852,12)'
'define var22 = ave(pow(runm2-clm22,2),t+0,t=852,12)'
'define var23 = ave(pow(runm3-clm23,2),t+0,t=852,12)'
'modify var21 seasonal'
'modify var22 seasonal'
'modify var23 seasonal'
'set time jan1950 'cmon''year
'define nidx21=(runm1-clm21)/sqrt(var21)'
'define nidx22=(runm2-clm22)/sqrt(var22)'
'define nidx23=(runm3-clm23)/sqrt(var23)'
*
'set vpage 0 8.5 0 11.0'
'set grads off'
'set parea 0.4 8.3 8.6 10.3'
'set axlim -3.5 3.5'
'set gxout linefill'
'set lfcols 2 4'
'set time jan1950 dec1964'
'aa=0'
'set yaxis -3.5 3.5 1'
'set grads off'
'd nidx21;aa'
*
'set gxout line'
'set cstyle 1'
'set cthick 5'
'set ccolor 1'
'set cmark 0'
'd nidx22'
'set cmark 0'
'set ccolor 3'
'd nidx23'
*
'set grads off'
'set parea 0.4 8.3 6.6 8.3'
'set axlim -3.5 3.5'
'set gxout linefill'
'set lfcols 2 4'
'set time jan1965 dec1979'
'aa=0'
'set cmark 0'
'set yaxis -3.5 3.5 1'
'set grads off'
'd nidx21;aa'
*
'set gxout line'
'set cstyle 1'
'set cthick 5'
'set ccolor 1'
'set cmark 0'
'd nidx22'
'set cmark 0'
'set ccolor 3'
'd nidx23'
*
'set grads off'
'set parea 0.4 8.3 4.6 6.3'
'set axlim -3.5 3.5'
'set gxout linefill'
'set lfcols 2 4'
'set time jan1980 dec1994'
'aa=0'
'set cmark 0'
'set yaxis -3.5 3.5 1'
'set grads off'
'd nidx21;aa'
*
'set gxout line'
'set cstyle 1'
'set cthick 5'
'set ccolor 1'
'set cmark 0'
'd nidx22'
'set cmark 0'
'set ccolor 3'
'd nidx23'
*
'set grads off'
'set parea 0.4 8.3 2.6 4.3'
'set axlim -3.5 3.5'
'set gxout linefill'
'set lfcols 2 4'
'set time jan1995 dec2009'
'aa=0'
'set cmark 0'
'set yaxis -3.5 3.5 1'
'set grads off'
'd nidx21;aa'
*
'set gxout line'
'set cstyle 1'
'set cthick 5'
'set ccolor 1'
'set cmark 0'
'd nidx22'
'set cmark 0'
'set ccolor 3'
'd nidx23'
*
'set grads off'
'set parea 0.4 8.3 0.6 2.3'
'set axlim -3.5 3.5'
'set gxout linefill'
'set lfcols 2 4'
'set time jan2010 dec2024'
'aa=0'
'set cmark 0'
'set yaxis -3.5 3.5 1'
'set grads off'
'd nidx21;aa'
*
'set gxout line'
'set cstyle 1'
'set cthick 5'
'set ccolor 1'
'set cmark 0'
'd nidx22'
'set cmark 0'
'set ccolor 3'
'd nidx23'
*
*'draw line 0.1 0.1 10.7 0.1'
*'draw line 0.1 0.1  0.1 8.4'
*'draw line 0.1 8.4 10.7 8.4'
*'draw line 10.7 0.1 10.7 8.4'
'set vpage 0 8.5 0 11.0'
'set strsiz 0.15'
'set string 4 tc 6'
'draw string 4.25 10.85 3-Month Running Mean NAO Index'
'set cthick 5'
'set line 1'
'set cmark 0'
'draw line 0.5 10.5 1.0 10.5'
'set string 1 tl 5'
'set strsiz 0.12'
'draw string 1.0 10.57 New-1 (AC=0.80)'
*
'set line 3'
'set cmark 0'
'draw line 3.5 10.5 4.0 10.5'
'set string 1 tl 5'
'set strsiz 0.12'
'draw string 4.0 10.57 New-2 (AC=0.96)'
*
'printim mon.nao.3lines.no_cos.proj.gif white'
'set t 1'
'define ac12=ave(nidx1*nidx2,t=1,t=870)'
'define ac13=ave(nidx1*nidx3,t=1,t=870)'
'define ac23=ave(nidx2*nidx3,t=1,t=870)'
*'disable'
*'quit'
