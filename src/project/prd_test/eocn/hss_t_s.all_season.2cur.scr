#!/bin/sh

set -eaux

lcdir=/export/hobbes/wd52pp/project/prd_skill
tmp=/export/hobbes/wd52pp/tmp
datadir=/export-12/cacsrv1/wd52pp/prd_skill
#
nseasons=192   #JFM1995-
#model=gocnv1
#model=gocn
 model=eocn
#model=nino34
#model=nino34_noflt
#model=ensocmp_3ctg
#model=ensocmp_5ctg
#model=ensocmp_noflt
#
/bin/rm $tmp/fort.*         
cp $lcdir/hss_t_s.f $tmp/.
cd $tmp
#
cat > parm.h << eof
       parameter(nss=$nseasons)
       parameter(ncd=102)
eof
#
#
f77 -o hss_t_s.x hss_t_s.f
echo "done compiling"

#
 ln -s $datadir/${model}prd_sfcT_102CD.jfm1995-djf2010.i3e   fort.10
 ln -s $datadir/wmoobs_sfcT_102CD.jfm1995-djf2010.i3e        fort.20
 ln -s $datadir/hss_$model.temp.uscd.jfm95-djf10.ts.gr    fort.30
 ln -s $datadir/hss_$model.temp.uscd.jfm95-djf10.cd.gr    fort.40
#
hss_t_s.x > $datadir/hss.${model}.temp.jfm1995-djf2010.out
#

cat>$datadir/hss_$model.temp.uscd.jfm95-djf10.ts.ctl<<EOF
dset ^hss_$model.temp.uscd.jfm95-djf10.ts.gr
undef 999.0
title Realtime Surface Obs
xdef    1 linear    0.000  1
ydef    1 linear    0.000  1
zdef    1 levels 500
tdef 999 linear jan1995  1mon
vars   1
hss    0 99 Type of Ob
endvars
EOF
#
cat>$datadir/hss_$model.temp.uscd.jfm95-djf10.cd.ctl<<EOF2
dset ^hss_$model.temp.uscd.jfm95-djf10.cd.gr
undef 999.0
title Realtime Surface Obs
xdef    102 linear    0.000  1
ydef    1 linear    0.000  1
zdef    1 levels 500
tdef 999 linear jan1995  1mon
vars   1
hss    0 99 Type of Ob
endvars
EOF2

