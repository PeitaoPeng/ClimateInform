#!/bin/sh

set -eaux

lcdir=/cpc/home/wd52pp/project/prd_test/eocn
tmp=/cpc/home/wd52pp/tmp
datadir=/cpc/home/wd52pp/data/prd_test
#
 var=temp
#var=prec
#
nseasons=264   #JFM1995-
eyear=2016
model=gocnv1
#model=gocn
#model=eocn
#model=nino34
#model=nino34_noflt
#model=ensocmp_3ctg
#model=ensocmp_5ctg
#model=ensocmp_noflt
#
/bin/rm $tmp/fort.*         
cp $lcdir/hss_t_s.f $tmp/.
cd $tmp
#
cat > parm.h << eof
       parameter(nss=$nseasons)
       parameter(ncd=102)
eof
#
#
gfortran -o hss_t_s.x hss_t_s.f
echo "done compiling"
#
#
 ln -s $datadir/${model}prd_${var}_102CD.jfm1995-djf$eyear.norm.i3e   fort.10
 ln -s $datadir/wmoobs_${var}_102CD.jfm1995-djf$eyear.i3e        fort.20
 ln -s $datadir/hss_$model.${var}.uscd.jfm1995-djf$eyear.ts.gr    fort.30
 ln -s $datadir/hss_$model.${var}.uscd.jfm1995-djf$eyear.cd.gr    fort.40
#
hss_t_s.x > $datadir/hss.${model}.${var}.jfm1995-djf$eyear.out
#

cat>$datadir/hss_$model.${var}.uscd.jfm1995-djf$eyear.ts.ctl<<EOF
dset ^hss_$model.${var}.uscd.jfm1995-djf$eyear.ts.gr
undef 999.0
title Realtime Surface Obs
xdef    1 linear    0.000  1
ydef    1 linear    0.000  1
zdef    1 levels 500
tdef 999 linear jan1995  1mon
vars   1
hss    0 99 Type of Ob
endvars
EOF
#
cat>$datadir/hss_$model.${var}.uscd.jfm1995-djf$eyear.cd.ctl<<EOF2
dset ^hss_$model.${var}.uscd.jfm1995-djf$eyear.cd.gr
undef 999.0
title Realtime Surface Obs
xdef    102 linear    0.000  1
ydef    1 linear    0.000  1
zdef    1 levels 500
tdef 999 linear jan1995  1mon
vars   1
hss    0 99 Type of Ob
endvars
EOF2

