28c28
<       real xout(ntout),sout(ntout),wout(ntout),kout(ntout)
---
>       real xout(ntout),sout(ntout),wout(ntout)
33c33
<       dimension out(36,19)
---
>       dimension kout(ntout),kmode(imax,12)
36,37c36,37
<       open(unit=60,form='unformatted',access='direct',recl=4*36*19)
<       open(unit=61,form='unformatted',access='direct',recl=4*36*19)
---
>       open(unit=60,form='unformatted',access='direct',recl=4*imax)
>       open(unit=61,form='unformatted',access='direct',recl=4*imax)
122,123c122
<       call CD102_2_2x2(wk3,out)
<       write(60,rec=iw) out
---
>       write(60,rec=iw) wk3
127a127,143
> c have the 1st mode of k for each season and each CD
> c
>       do ite=1,ntout
>       do is=1,12
>       do im=1,imax
> c
>       do it=1,ite
> c     kout(it)=kmax_t(im,is,it)
>       enddo
> c     call mode_k(kout,ntout,ite,kp,kmode(im,is))
> 
> c     kmax_t2(im,is,ite)=kmode(im,is)
> 
>       enddo
>       enddo
>       enddo
> c
156,157c172
<       call CD102_2_2x2(wk3,out)
<       write(61,rec=iw) out
---
>       write(61,rec=iw) wk3
159,160c174
<       call CD102_2_2x2(wk4,out)
<       write(61,rec=iw) out
---
>       write(61,rec=iw) wk4
1071a1086,1110
>       subroutine mode_k(kk,lt,nt,kp,kmode)
>       dimension kk(lt)
> c
>       kmode=-999
>       kc2=0
> c
>       do k=1,kp
> 
>       kc1=0
>       do it=1,nt
> 
>       if(kk(it).eq.k) then
>       kc1=kc1+1
>       endif
> 
>       enddo
>       if(kc1.gt.kc2) then
>       kc2=kc1
>       kmode=k
>       endif
> 
>       enddo
> 
>       return
>       end
