10c10
<       real fld3d(ncd,lreal)
---
>       real fld3d(ncd,ltime+1)
13c13
<       real fldin(ncd)
---
>       real fldin(ncd,ltime+1,12)
27c27
<       open(10,form='unformatted',access='direct',recl=4*ncd)
---
>       open(unit=10,form='formatted') !monthly cd temp or prec
34,44c34,38
< ccc loop over time
< 
<       iu=10
<       its=iskip+1
< c
< c read in data
< c
<       iread=0
<       do it=its,ltime,itdel
<         read(iu,rec=it) fldin
<         iread=iread+1
---
> c== read in 102CD data (1931-cur)
>       do ny=1,ltime+1
>       do m=1,12
>         read(10,888) fld1
>  888  format(10f7.1)
46c40
<           fld3d(i,iread)=fldin(i)
---
>           fldin(i,ny,m)=fld1(i)
49c43,46
<       write(6,*) 'iread=',iread
---
>       enddo
> c
> c== seasonal mean
>       call season_anom(fldin,ltime+1,1,ltime,iseason,ncd,fld3d)
53c50
<       do it=1,iread-ml+1
---
>       do it=1,ltime-ml+1
70c67
<       write(6,*) 'irec= ',iread
---
>       write(6,*) 'irec= ',ltime
301a299,427
>       subroutine season_mean(fld,nyear,mons,nmax,out)
> CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
> C. calculate seasonal mean of 102 cd data
> C===========================================================
>       real fld(nmax,nyear,12)
>       real clim(nmax,12),out(nmax,nyear-1)
> c
>       IF(mons.eq.12) THEN
> 
>       m1=12
>       m2=1
>       m3=2
> c
>       do ny=1,nyear-1
>         do i=1,nmax
>         out(i,ny)=(fld(i,ny,m1)+fld(i,ny+1,m2)+fld(i,ny+1,m3))/3.
>         enddo
>       enddo
> 
>       ELSE IF (mons.eq.11) THEN
> c
> 
>       m1=11
>       m2=12
>       m3=1
> c
>       do ny=1,nyear-1
>         do i=1,nmax
>         out(i,ny)=(fld(i,ny,m1)+fld(i,ny,m2)+fld(i,ny+1,m3))/3.
>         enddo
>       enddo
> c
>       ELSE
> 
>       m1=mons      !m1=1 -> JFM;
>       m2=m1+1
>       m3=m2+1
> c
>       do ny=1,nyear-1
>         do i=1,nmax
>         out(i,ny)=(fld(i,ny,m1)+fld(i,ny,m2)+fld(i,ny,m3))/3.
>         enddo
>       enddo
> 
>       END IF
> c
>       return
>       END
>       subroutine season_anom(fld,nytot,nys,nyear,mons,nmax,out)
> CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
> C. calculate seasonal anom & clim of 102 cd data
> C===========================================================
>       real fld(nmax,nytot,12)
>       real clim(nmax,12),out(nmax,nytot)
> c
>       call setzero(clim,nmax,12)
>       do m=1,12
>       do ny=nys,nyear-1
>         do i=1,nmax
>          clim(i,m)=clim(i,m)+fld(i,ny,m)/float(nyear-nys)
>         enddo
>       end do
>       end do
> c
> c have seasonal mean
> c
>       IF(mons.eq.12) THEN
> 
>       m1=12
>       m2=1
>       m3=2
> c
> c for history
>       do ny=nys,nyear-1
>         do i=1,nmax
>         out(i,ny)=(fld(i,ny,m1)+fld(i,ny+1,m2)+fld(i,ny+1,m3)-
>      &         (clim(i,m1)+clim(i,m2)+clim(i,m3)))/3.
>         enddo
>       enddo
> c for target year
>         do i=1,nmax
>       out(i,nyear)=(fld(i,nyear,m1)+fld(i,nyear+1,m2)+fld(i,nyear+1,m3)-
>      &         (clim(i,m1)+clim(i,m2)+clim(i,m3)))/3.
>         enddo
> 
>       ELSE IF (mons.eq.11) THEN
> c
> 
>       m1=11
>       m2=12
>       m3=1
> c
> c for history
>       do ny=nys,nyear-1
>         do i=1,nmax
>         out(i,ny)=(fld(i,ny,m1)+fld(i,ny,m2)+fld(i,ny+1,m3)-
>      &         (clim(i,m1)+clim(i,m2)+clim(i,m3)))/3.
>         enddo
>       enddo
> c for target year
>         do i=1,nmax
>       out(i,nyear)=(fld(i,nyear,m1)+fld(i,nyear,m2)+fld(i,nyear+1,m3)-
>      &         (clim(i,m1)+clim(i,m2)+clim(i,m3)))/3.
>         enddo
> c
>       ELSE
>       m1=mons      !m1=1 -> JFM;
>       m2=m1+1
>       m3=m2+1
> c
> c for history
>       do ny=nys,nyear-1
>         do i=1,nmax
>         out(i,ny)=(fld(i,ny,m1)+fld(i,ny,m2)+fld(i,ny,m3)-
>      &         (clim(i,m1)+clim(i,m2)+clim(i,m3)))/3.
>         enddo
>       enddo
> c for target year
>         do i=1,nmax
>       out(i,nyear)=(fld(i,nyear,m1)+fld(i,nyear,m2)+fld(i,nyear,m3)-
>      &         (clim(i,m1)+clim(i,m2)+clim(i,m3)))/3.
>         enddo
> 
>       END IF
> c
>       return
>       END
> 
> 
