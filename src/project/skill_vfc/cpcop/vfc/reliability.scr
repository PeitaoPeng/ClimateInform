#!/bin/sh

set -eaux

lcdir=/cpc/home/wd52pp/project/skill_vfc/cpcop
tmp=/cpc/home/wd52pp/tmp
datadir1=/cpc/home/wd52pp/data/cpc_vfc/0data
datadir2=/cpc/home/wd52pp/data/cpc_vfc/skill
#
for var in temp prec; do
#var=temp
#var=prec
nseason=331
nyears=27
tool=cpc
#
/bin/rm $tmp/fort.*         
cp $lcdir/vfc/roc.all_season.f $tmp/roc.f
cp $lcdir/vfc//roc_area.s.f $tmp/.
cd $tmp
#
cat > parm.h << eof
       parameter(nss=$nseason)
       parameter(nyr=$nyears)
       parameter(imx=36,jmx=19)
eof
#
#
#gfortran -frecord-marker=4 -o roc.x roc_area.s.f roc.f
gfortran -o roc.x roc_area.s.f roc.f
echo "done compiling"

#
 ln -s $datadir1/mask_2x2.data    fort.11
 ln -s $datadir1/${var}01_forecast_below.bi  fort.12
 ln -s $datadir1/${var}01_forecast_above.bi  fort.13
 ln -s $datadir1/${var}_seas_verif.bi        fort.14
 ln -s $datadir1/${var}01_forecast.bi        fort.15
#
 ln -s $lcdir/plot_vfc/roc_a_${var}.95-cur.$tool.txt  fort.61
 ln -s $lcdir/plot_vfc/roc_b_${var}.95-cur.$tool.txt  fort.62
 ln -s $datadir2/rlb_hsg.$var.95-cur.$tool.gr         fort.65
#
roc.x > $lcdir/vfc/rlib_out.$var
#

cat>$datadir2/rlb_hsg.$var.95-cur.$tool.ctl<<EOF
dset $datadir2/rlb_hsg.$var.95-cur.$tool.gr
undef -9999.0
title Realtime Surface Obs
xdef  20 levels 0.025 0.075 0.125 0.175 0.225 0.292 0.333 0.367 0.425 0.475 0.525 0.575 0.625 0.675 0.725 0.775 0.825 0.875 0.925 0.975
ydef   1 linear    0.000  5
zdef   1 levels 500
tdef   1 linear feb1995  1mon
vars   8
hoa    0 99 percent of nonec grids
hob    0 99 percent of nonec grids
hon    0 99 percent of nonec grids
foa    0 99 percent of nonec grids
fob    0 99 percent of nonec grids
fon    0 99 percent of nonec grids
rga    0 99 weithed regr of above
rgb    0 99 weithed regr of above
endvars
EOF

done
